<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" type="text/css" href="lib/css/bootstrap.min.css">
        <link rel="stylesheet" type="text/css" href="lib/css/mab-jquery-taginput.css">
        <style>
            body { 
                min-width: 420px; 
                overflow-x: hidden; 
            }
            #addbookmark {
                padding: 15px 15px 0 15px;
            }
        </style>
        <script src="lib/js/jquery.min.js"></script>
        <script src="lib/js/bootstrap.min.js"></script>
        <script src="lib/js/typeahead.bundle.min.js"></script>
        <script src="lib/js/mab-jquery-taginput.js"></script>
        <script src="popup.js"></script>
    </head>
    <body>
        <form id="addbookmark">
            <div class="form-group">
                <label for="title">Title</label>
                <input class="form-control" type="text" id="title" name="title" size="50" value="" />
            </div>
            <div class="form-group">
                <label for="url">Url</label>
                <input class="form-control" type="text" id="url" name="url" size="50" value="" />
            </div>
            <div class="form-group">
                <label for="abstract">Abstract</label>
                <textarea class="form-control" id="abstract" name="abstract" rows="5" cols="35"></textarea>
            </div>
            <div class="form-group">
                <label for="tags">Tags</label>
                <input class="form-control" type="text" id="tags" name="tags" size="50" value="" />
            </div>
            <div class="form-group">
                <input class="btn btn-primary" id="save" type="submit" value="Save Bookmark" />
            </div>
        </form>
        <script type="text/javascript">

            $(function(){

                // Instantiate the Bloodhound suggestion engine
                var tags = new Bloodhound({
                    datumTokenizer: function(d) { return Bloodhound.tokenizers.whitespace(d.tag); },
                    queryTokenizer: Bloodhound.tokenizers.whitespace,
                    // local: [
                    //     { tag: 'tag1' },
                    //     { tag: 'tag2' },
                    //     { tag: 'tag3' }
                    // ]
                    prefetch: {
                        // Currently this just reloads all tags on every page refresh
                        // We'll need to refine this once AJAX updates start happening
                        thumbprint: new Date().getTime(),
                        url: 'http://localhost:5000/tags',
                        filter: function(data) {
                            return data.tags;
                        }
                    }
                });

                tags.initialize();

                $('#tags').tagInput({
                    allowDuplicates: false,
                    typeahead: true,
                    typeaheadOptions: {
                        displayKey: 'tag',
                        source: tags.ttAdapter()
                    }
                });

            });

        </script>
    </body>
</html>